[env:waveshare-esp32-s3]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

; Upload settings
upload_speed = 921600
monitor_speed = 115200

; Board configuration for Waveshare ESP32-S3R2 with 2MB QSPI PSRAM
board_build.mcu = esp32s3
board_build.f_cpu = 240000000L
board_build.flash_mode = qio
board_build.flash_size = 16MB
board_build.partitions = default_16MB.csv
board_build.arduino.memory_type = qio_qspi

; Build flags
build_flags =
    ; USB Serial
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1

    ; PSRAM Configuration for QSPI (ESP32-S3R2)
    -DBOARD_HAS_PSRAM
    -DCONFIG_SPIRAM_MODE_QUAD=1
    -DCONFIG_SPIRAM_TYPE_ESPPSRAM16=1

    ; LVGL Configuration
    -DLV_CONF_INCLUDE_SIMPLE
    -DLV_CONF_PATH="${PROJECT_DIR}/include/lv_conf.h"

    ; Display configuration
    -DDISPLAY_WIDTH=240
    -DDISPLAY_HEIGHT=320
    -DDISPLAY_ROTATION=0

    ; Embed GIF file into firmware
    -DEMBEDDED_GIF=1

    ; Add include path for assets
    -I include

    ; WebSockets compatibility
    -DWEBSOCKETS_NETWORK_TYPE=NETWORK_ESP32

    ; Enable LittleFS filesystem
    -DUSE_LITTLEFS

; Libraries
lib_deps =
    lvgl/lvgl@^8.3.11
    arduino-libraries/NTPClient@^3.2.1
    bblanchon/ArduinoJson@^7.2.1
    esphome/ESPAsyncWebServer-esphome@^3.0.0
    esphome/AsyncTCP-esphome@^2.1.4
    ricmoo/QRCode@^0.0.1
    knolleary/PubSubClient@^2.8
    links2004/WebSockets@^2.5.1
    ; LittleFS is built-in to ESP32 Arduino framework (no external library needed)

; Library configuration (changed from deep+ to chain for WebSocket WiFi.h compatibility)
lib_ldf_mode = chain


board_upload.flash_size = 16MB

; LittleFS filesystem (enabled for better large file support)
board_build.filesystem = littlefs